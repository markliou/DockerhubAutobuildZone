name: container_gpu_test

# main branch for publishing
on:
  workflow_run:
    workflows:
      - docker_image_evaluating_process
      - docker_image_publishing_process
    branches:
      - master
      - dev
    types:
      - completed

jobs:
  evaluating:
    runs-on:
      - gpu

    steps:
      - name: gpu_test
        uses: actions/checkout@v4
      - run: docker pull docker markliou/dl-container:temp
      - run: docker run -it --rm --gpus all markliou/dl-container:temp gpu_test
      - run: docker pull docker markliou/dl-container:latest
      - run: docker run -it --rm --gpus all markliou/dl-container:latest gpu_test

